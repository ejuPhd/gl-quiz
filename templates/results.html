<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Results - ML Quiz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="container">
        <header>
            <h1>üéâ Quiz Complete!</h1>
            <p>Here's how you performed</p>
        </header>

        <div class="results-summary">
            <div class="score-card">
                <div class="score-circle">
                    <span class="score">{{ score }}</span>
                    <span class="max-score">/ {{ total_questions * {'beginner': 10, 'intermediate': 20, 'advanced':
                        30}[difficulty] }}</span>
                </div>
                <div class="score-details">
                    <h3>Final Score</h3>
                    <p>{{ correct_count }} out of {{ total_questions }} correct</p>
                    <p class="difficulty-badge {{ difficulty }}">{{ difficulty|title }} Level</p>
                </div>
            </div>

            <div class="performance-stats">
                <div class="stat">
                    <span class="stat-value">{{ "%.1f"|format((correct_count / total_questions) * 100) }}%</span>
                    <span class="stat-label">Accuracy</span>
                </div>
                <div class="stat">
                    <span class="stat-value">{{ correct_count }}</span>
                    <span class="stat-label">Correct</span>
                </div>
                <div class="stat">
                    <span class="stat-value">{{ total_questions - correct_count }}</span>
                    <span class="stat-label">Incorrect</span>
                </div>
            </div>
        </div>

        <div class="results-actions">
            <form action="{{ url_for('save_score') }}" method="post" class="save-score-form">
                <input type="text" name="player_name" placeholder="Enter your name" required maxlength="20">
                <button type="submit" class="btn primary">Save Score</button>
            </form>
            <div class="action-buttons">
                <a href="{{ url_for('restart') }}" class="btn secondary">Play Again</a>
                <a href="{{ url_for('leaderboard') }}" class="btn tertiary">View Leaderboard</a>
            </div>
        </div>

        <div class="detailed-results">
            <h3>Question Review</h3>
            {% for result in results %}
            <div class="result-item {% if result.is_correct %}correct{% else %}incorrect{% endif %}">
                <div class="result-header">
                    <span class="question-number">Q{{ loop.index }}</span>
                    <span class="result-status">
                        {% if result.is_correct %}‚úÖ Correct{% else %}‚ùå Incorrect{% endif %}
                    </span>
                </div>

                <p class="question-text">{{ result.question.question }}</p>

                {% if result.question.code_snippet %}
                <div class="code-snippet">
                    <pre><code>{{ result.question.code_snippet }}</code></pre>
                </div>
                {% endif %}

                <div class="answer-comparison">
                    <div class="answer your-answer">
                        <strong>Your answer:</strong>
                        <span>{{ result.question.options[result.user_answer] if result.user_answer is not none else "No
                            answer" }}</span>
                    </div>
                    <div class="answer correct-answer">
                        <strong>Correct answer:</strong>
                        <span>{{ result.question.options[result.question.correct_answer] }}</span>
                    </div>
                </div>

                <div class="explanation">
                    <strong>Explanation:</strong>
                    <p>{{ result.question.explanation }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</body>

</html>